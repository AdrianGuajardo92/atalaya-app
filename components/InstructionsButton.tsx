'use client';

import { useState } from 'react';

export default function InstructionsButton() {
  const [showCopied, setShowCopied] = useState(false);

  const promptInstructions = `# Instrucciones para trabajar con la aplicaci√≥n Atalaya

## üìã Contexto de la aplicaci√≥n

Esta es una aplicaci√≥n Next.js para dirigir estudios de La Atalaya con soporte biling√ºe (Espa√±ol y LSM - Lengua de Se√±as Mexicana).

## üóÇÔ∏è Estructura de archivos

**ARCHIVO PRINCIPAL A MODIFICAR CADA SEMANA:**
- \`data/atalaya-data.ts\` - √öNICO archivo que se modifica semanalmente con el contenido del nuevo estudio

**ARCHIVOS QUE NUNCA SE MODIFICAN:**
- \`components/QuestionCard.tsx\` - Componente de preguntas (dise√±o Tarjetas Compactas)
- \`components/ReviewQuestionCard.tsx\` - Componente de preguntas de repaso
- \`components/StudyHeader.tsx\` - Encabezado del estudio
- \`components/Timer.tsx\` - Temporizador flotante arrastrable
- \`app/page.tsx\` - P√°gina principal con l√≥gica de navegaci√≥n
- \`types/atalaya.ts\` - Definici√≥n de tipos TypeScript
- \`app/api/lsm/route.ts\` - API para guardar traducciones LSM en Vercel KV

## üìù C√≥mo actualizar el contenido semanal

### Paso 1: Abrir el archivo de datos
Abre el archivo: \`data/atalaya-data.ts\`

### Paso 2: Actualizar la informaci√≥n del estudio
Modifica el objeto \`atalayaData\` con la nueva informaci√≥n:

\`\`\`typescript
export const atalayaData: AtalayaStudy = {
  // 1. CANCI√ìN INICIAL
  song: "Canci√≥n XXX",

  // 2. T√çTULO DEL ESTUDIO
  title: "T√≠tulo completo del estudio",

  // 3. TEXTO B√çBLICO (las referencias b√≠blicas se resaltan autom√°ticamente)
  biblicalText: "\"Texto entre comillas\" (REFERENCIA B√çBLICA)",

  // 4. TEMA
  theme: "Texto del tema completo",

  // 5. PREGUNTAS (Array de preguntas)
  questions: [
    {
      number: "1, 2",              // N√∫mero(s) de pregunta
      textEs: "¬øPregunta completa en espa√±ol?",
      textLSM: "",                  // Dejar vac√≠o, se llena en la app
      paragraphs: [1, 2],           // N√∫meros de p√°rrafos relacionados
      section: "SUBT√çTULO OPCIONAL", // Solo si hay subt√≠tulo
      sectionLSM: "",               // Dejar vac√≠o, se llena en la app
      answer: "Respuesta en lenguaje sencillo basada en los p√°rrafos",
      answerBullets: "‚Ä¢ Punto clave 1\\n‚Ä¢ Punto clave 2\\n‚Ä¢ Punto clave 3",
      flashcards: [                 // Tarjetas did√°cticas (OPCIONAL - agregar conforme se estudia)
        {
          question: "¬øPregunta sobre dato espec√≠fico del p√°rrafo?",
          answer: "Respuesta breve y directa"
        }
      ]
    },
    // ... m√°s preguntas
  ],

  // 6. P√ÅRRAFOS (Array de p√°rrafos completos)
  paragraphs: [
    {
      number: 1,
      content: "Contenido completo del p√°rrafo con referencias b√≠blicas (LIBRO 1:1)."
    },
    // ... m√°s p√°rrafos
  ],

  // 7. PREGUNTAS DE REPASO (Array de preguntas finales)
  reviewQuestions: [
    {
      question: "¬øPregunta de repaso en espa√±ol?",
      questionLSM: ""  // Dejar vac√≠o, se llena en la app
    },
    // ... m√°s preguntas de repaso
  ],

  // 8. CANCI√ìN FINAL
  finalSong: "Canci√≥n XXX y oraci√≥n"
};
\`\`\`

### Paso 3: Formato especial para preguntas

**Preguntas simples:**
\`\`\`typescript
{
  number: "3",
  textEs: "¬øPregunta?",
  textLSM: "",
  paragraphs: [3]
}
\`\`\`

**Preguntas m√∫ltiples (mismo p√°rrafo):**
\`\`\`typescript
{
  number: "4, 5",
  textEs: "¬øPrimera pregunta y segunda pregunta?",
  textLSM: "",
  paragraphs: [4]
}
\`\`\`

**Pregunta con subt√≠tulo de secci√≥n:**
\`\`\`typescript
{
  number: "6",
  textEs: "¬øPregunta?",
  textLSM: "",
  paragraphs: [6],
  section: "SUBT√çTULO EN MAY√öSCULAS",  // Aparece antes de la pregunta
  sectionLSM: ""                       // Se traduce en la app
}
\`\`\`

### Paso 4: Respuestas y puntos clave

**Respuesta simple:**
\`\`\`typescript
answer: "Explicaci√≥n directa en lenguaje sencillo de lo que responde la pregunta"
\`\`\`

**Puntos clave (bullets):**
\`\`\`typescript
answerBullets: "**Subt√≠tulo opcional**\\n‚Ä¢ Punto 1\\n‚Ä¢ Punto 2\\n‚Ä¢ Punto 3"
\`\`\`

### Paso 5: Tarjetas did√°cticas (Flashcards)

Las flashcards son **OPCIONALES** y se agregan **conforme se estudia**, no todas de golpe:

**Caracter√≠sticas:**
- Aparecen **debajo de las respuestas**
- Ocultas por defecto en modo scroll (bot√≥n para mostrar/ocultar)
- Siempre visibles en modo navegaci√≥n
- Estilo flip card (click para voltear)

**Cu√°ndo agregar:**
- Solo cuando el usuario lo pida
- Conforme se estudian los p√°rrafos
- No generar todas autom√°ticamente

**Qu√© incluir:**
‚úÖ Referencias b√≠blicas importantes
‚úÖ Datos espec√≠ficos relevantes
‚úÖ Conceptos clave del p√°rrafo
‚úÖ Informaci√≥n que ayude a recordar puntos principales

**Qu√© NO incluir:**
‚ùå Nombres de ejemplos personales (ej: "Jennifer")
‚ùå Detalles sin importancia
‚ùå Informaci√≥n obvia

**Ejemplo:**
\`\`\`typescript
flashcards: [
  {
    question: "¬øQu√© significa la palabra hebrea 'perdonar' en Salmo 32:5?",
    answer: "Tambi√©n significa 'levantar' o 'llevar'"
  },
  {
    question: "¬øCu√°les son las 3 condiciones para que Jehov√° nos perdone?",
    answer: "Arrepentirnos, confesar y no volver a cometer el pecado"
  }
]
\`\`\`

**Lenguaje:**
- Preguntas claras y directas
- Respuestas breves (1-2 oraciones m√°ximo)
- Lenguaje sencillo y f√°cil de entender

### Paso 6: P√°rrafos con referencias b√≠blicas
Las referencias b√≠blicas entre par√©ntesis se resaltan autom√°ticamente en azul:

\`\`\`typescript
{
  number: 5,
  content: "Texto del p√°rrafo que menciona (Salmo 32:5) y tambi√©n (1 Juan 1:9). Todo esto se resalta autom√°ticamente."
}
\`\`\`

## üé® Caracter√≠sticas de la aplicaci√≥n

### Modos de visualizaci√≥n:
1. **Modo Scroll** - Ver todas las preguntas en una p√°gina
2. **Modo Navegaci√≥n** - Ver una pregunta a la vez con botones Anterior/Siguiente

### Funcionalidades:
- ‚úÖ Edici√≥n de texto LSM (click en √°rea LSM para editar)
- ‚úÖ Guardado autom√°tico en Vercel KV
- ‚úÖ Sincronizaci√≥n entre localhost y producci√≥n
- ‚úÖ Temporizador flotante y arrastrable
- ‚úÖ Ver p√°rrafos completos (click en c√≠rculo azul con n√∫mero)
- ‚úÖ **Respuestas con dos niveles**: explicaci√≥n simple + puntos clave
- ‚úÖ **Tarjetas did√°cticas (flashcards)**: flip cards para repasar datos importantes
- ‚úÖ Atajos de teclado:
  - Enter: Guardar LSM
  - Escape: Cancelar edici√≥n
  - Shift+Enter: Nueva l√≠nea en textarea

### Dise√±o "Tarjetas Compactas":
- C√≠rculo azul con n√∫mero (clickeable para ver p√°rrafos)
- Espa√±ol en caja gris
- LSM en caja azul (m√°s grande y destacado)
- Todo el texto LSM se muestra autom√°ticamente en MAY√öSCULAS

## üîÑ Flujo de trabajo semanal

1. **Obtener el nuevo estudio** de jw.org
2. **Abrir**: \`data/atalaya-data.ts\`
3. **Reemplazar** todo el contenido con el nuevo estudio
4. **Verificar** que la estructura sea correcta
5. **Probar** en localhost: \`npm run dev\`
6. **Traducir** las preguntas a LSM usando la interfaz
7. **Hacer commit** cuando est√© listo
8. **Hacer push** para desplegar en Vercel

## ‚ö†Ô∏è IMPORTANTE

- **NUNCA modificar** componentes ni archivos de configuraci√≥n
- **SOLO modificar** \`data/atalaya-data.ts\` cada semana
- **Dejar vac√≠os** los campos \`textLSM\`, \`sectionLSM\`, \`questionLSM\` - se llenan en la interfaz
- **Las traducciones LSM se guardan** autom√°ticamente en Vercel KV con clave √∫nica: \`atalaya-lsm-data\`
- **Los commits los hace el usuario**, nunca autom√°ticos

## üóÑÔ∏è Base de datos

- **Vercel KV** (Redis): biblioteca-db
- **Clave √∫nica**: \`atalaya-lsm-data\`
- **Sincronizaci√≥n**: localhost y producci√≥n usan la misma BD
- **Credenciales**: en \`.env.local\` (no en git)

## üì¶ Comandos √∫tiles

\`\`\`bash
npm run dev          # Iniciar desarrollo (localhost:3000)
npm run build        # Construir para producci√≥n
npm run start        # Iniciar producci√≥n local
git add .            # Agregar cambios
git commit -m "msg"  # Hacer commit
git push             # Desplegar a Vercel
\`\`\`

## üí° Tips

- Si necesitas agregar un nuevo estudio, **solo copia y pega** el contenido en el formato mostrado arriba
- Los subt√≠tulos son **opcionales**, solo agr√©galos si el estudio los tiene
- Las preguntas de repaso est√°n **separadas** de las preguntas normales
- El navegador **cachea** las traducciones LSM, as√≠ que si actualizas ver√°s tus traducciones anteriores

---

## üìö FUNCI√ìN ADICIONAL: Ayuda para estudiar el art√≠culo

Adem√°s de mantener la aplicaci√≥n, tambi√©n puedes pedirme que te ayude a **estudiar el art√≠culo p√°rrafo por p√°rrafo**.

### C√≥mo funciona:

Cuando el usuario diga algo como:
- "Ay√∫dame a estudiar el art√≠culo"
- "Vamos a estudiar p√°rrafo por p√°rrafo"
- "Dame las respuestas a las preguntas"

**Debes hacer lo siguiente:**

1. **Ir p√°rrafo por p√°rrafo** (o grupo de p√°rrafos seg√∫n las preguntas)
2. **Mostrar la pregunta** del estudio
3. **Dar la respuesta directa** bas√°ndote en el contenido de los p√°rrafos
4. **Usar lenguaje sencillo y f√°cil de entender**
5. **Ser conciso** - solo la respuesta directa a lo que se pregunta
6. **Esperar confirmaci√≥n** del usuario antes de continuar al siguiente grupo de p√°rrafos

### Ejemplo de formato:

\`\`\`
## üìñ P√°rrafos 1, 2

**Pregunta:** ¬øQu√© hace Jehov√° cuando nos arrepentimos, y c√≥mo nos hace sentir eso?

**Respuesta:**
Cuando nos arrepentimos de verdad, Jehov√° nos perdona completamente. Es como si borrara nuestros pecados y nunca los hubi√©ramos cometido. Esto nos hace sentir felices y aliviados, igual que se sinti√≥ el rey David cuando fue perdonado.

---

¬øListo para continuar con los p√°rrafos 3, 4? üòä
\`\`\`

### Reglas importantes para las respuestas:

‚úÖ **Respuesta directa** - No des informaci√≥n extra que no responda la pregunta
‚úÖ **Lenguaje sencillo** - Como si le hablaras a alguien que est√° aprendiendo
‚úÖ **Basada en los p√°rrafos** - Usa solo la informaci√≥n de los p√°rrafos correspondientes
‚úÖ **Concisa** - 2-4 oraciones m√°ximo por respuesta
‚úÖ **Clara** - Evita vocabulario complicado o teol√≥gico innecesario

### Ejemplo de c√≥mo NO responder:

‚ùå "Bueno, si analizamos el contexto hist√≥rico de David y consideramos las implicaciones teol√≥gicas del perd√≥n divino en el marco del pacto mosaico..."

### Ejemplo de c√≥mo S√ç responder:

‚úÖ "Jehov√° nos perdona completamente cuando nos arrepentimos. Esto nos hace sentir felices y aliviados."

---

**¬øNecesitas ayuda?** Pregunta sobre cualquier parte de esta estructura y te ayudar√© a mantener la consistencia del proyecto.`;

  const handleCopy = async () => {
    try {
      await navigator.clipboard.writeText(promptInstructions);
      setShowCopied(true);
      setTimeout(() => setShowCopied(false), 2000);
    } catch (err) {
      alert('Error al copiar. Intenta de nuevo.');
    }
  };

  return (
    <div className="fixed bottom-4 left-4 z-10 hidden lg:block">
      <button
        onClick={handleCopy}
        className="bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-lg shadow-lg hover:from-green-600 hover:to-green-700 transition-all font-medium text-sm flex items-center gap-2"
        title="Copiar instrucciones para nueva conversaci√≥n"
      >
        üìã Copiar Instrucciones
      </button>

      {showCopied && (
        <div className="absolute bottom-full left-0 mb-2 bg-green-600 text-white px-3 py-1 rounded shadow-lg text-sm whitespace-nowrap">
          ‚úÖ ¬°Copiado al portapapeles!
        </div>
      )}
    </div>
  );
}
